#include <stdio.h>
#include <stdlib.h>

int main(int argc, char ** argv)
{

    if(argc < 2)
    {
        printf("Usage: %s file_name\n", argv[0]);
        exit(EXIT_FAILURE);
    }
    FILE * fin,*fout;
    char line[BUFSIZ];
    fin = fopen(argv[1], "r");
    if(fin == NULL)
    {
        perror(argv[1]);
        exit(EXIT_FAILURE);
    }

    fout = popen("wc -l", "w");
    if(fout == NULL)
    {
        perror(argv[1]);
        exit(EXIT_FAILURE);
    }
    while (fgets(line, BUFSIZ, fin) != NULL)
    {
        if (line[0] == '\n')
        fputs(line, fout);
    }
    int checkClose;
    checkClose = fclose(fin);
    if(checkClose == -1)
    {
        perror(argv[1]);
        exit(EXIT_FAILURE);
    }
    checkClose = pclose(fout);
    if(checkClose == -1)
    {
        perror("Unable to close fout");
        exit(EXIT_FAILURE);
    }
    exit(EXIT_SUCCESS);
}